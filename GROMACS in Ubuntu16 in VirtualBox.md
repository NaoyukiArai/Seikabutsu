# VirtualBox5.2.14にUbuntu16.04を入れてgromacs-5.0.7を入れる

著者：NaoyukiArai

初版：2018/07/09　改訂十一版：2018/09/10　更新終了


※共有フォルダの設定よりも前に一つでも進めないところがあれば、最初からやり直すこと。

## 1.　VirtualBoxの仮想マシンの新規作成
1. VirtualBoxの新規ボタンをクリックする。

    1. 名前とオペレーティングシステム
        - 「名前」（仮想マシンの名前）を入れる。  
        - 「タイプ」をLinuxにする。  
        - 「バージョン」をUbuntu(64bit)にする。

    2. メモリーサイズ
        - コンピュータのメモリを超えないように値を設定する。

    3. ハードディスク
        - 「仮想ハードディスクを作成する」にチェックを入れる。

    4. ファイルの場所
        - 好きなパスにする。容量の大きなドライブのほうがよい。

    5. ファイルサイズ
        - 設定したファイルの場所のドライブの空き容量を超えないように設定する。

    6. ハードディスクのファイルタイプ
        - VDIに設定する。

    7. 物理ハードディスクにあるストレージ
        - 可変サイズに設定。

2. 新規に作った仮想マシンをダブルクリック。

3. 「起動ハードディスクを選択」で、ホストドライブ'D'をUbuntuのisoファイルに変えて起動。

## 2. Ubuntu初期設定
1. ようこそ
    - 「Ubuntuをインストール」をクリック。

2.  Ubuntuのインストール準備
    - 「Ubuntuのインストール中にアップデートをクリックする」をチェック。
    - 「グラフィックス、Wi-Fi機器、Flash、MP3やその他のメディアに必要なサードパーティソフトウェアをインストールする」にチェック。
    - 「続ける」をクリック。

3. インストールの種類
    - 「ディスクを削除してUbuntuをインストール」にチェック。
    - 「インストール」をクリック。

4. ディスクに変更を書き込みますか？
   - 「続ける」をクリック。

5. どこに住んでいますか？
    - 「Tokyo」にする。
    - 「続ける」をクリック。

6. キーボードレイアウト
    - どちらも「日本語（無印）」を選択.
    - 「続ける」をクリック。

7. あなたの情報を入力してください。
    - ここはスーパーユーザー（管理者）の情報なので自分の好きなように入れる。
    - 「続ける」をクリック。

## 3. Ubuntu初期設定後の環境構築
1. 「今すぐ再起動」をクリック。  
※再起動しないとき 仮想マシンを閉じて再度開く。このとき、「仮想マシンの電源オフ」にチェックを入れてOKする。

2. 起動後、Ubuntuのインストールの画面が出るときは、仮想マシンを一旦閉じ、仮想マシンの「設定」の「ストレージ」の「コントローラーIDE」の「メディア」のUbuntuのisoファイルをクリックで選択し、属性の光学ドライブ（D）の一番右のディスクマークをクリックし、「仮想ドライブからディスク除去」をクリックする。「コントローラーIDE」が空になっているのを確認し、OKボタンを押して設定を終了し、もう一度仮想マシンを起動する。

3. ランチャーの「システム設定」から「詳細」を開き、少し待って、「更新のインストール」が表示されると、それをクリックする。リポジトリの情報のダウンロードに失敗しても気にしないでOKを押す。このときダウンロードされるファイルの総容量が439.9MB（2018/07/14現在）を超えていれば成功確率が高い。

4. 「今すぐインストール」をクリック。

5. 途中で32:9？のアスペクト比になり、「ソフトウェアの更新」という大きな文字が点滅して左半分に出た状態になりバグるが、まずWindowsのタスクバーを右クリックし「タスクマネージャー」をクリックすることによってタスクマネージャーを起動する。次に、「プロセス」から、「VirtualBox Manager」を探し、「ディスク」と「インターネットの通信」のところを見る。ここで、ディスクへの読み書きと通信がなくなったかどうかを見極めて、読み書きと通信がなくなった時に仮想マシンを閉じて再度開く。このとき、「仮想マシンの電源オフ」にチェックを入れてOKする。

6. ここで「end Kernel panic」になったら、仮想マシンを最初からやり直すしかないようだ。

7. 画面のアスペクト比が4:3から16:9になったのを確認し、ランチャーの「システム設定」から「詳細」を開き、少し待って、「更新のインストール」が表示されたら、それをクリックすると、「このコンピュータのソフトウェアは最新です。」とでるのを確認する。

8. VirtualBoxの「デバイス」の「共有フォルダ」の「共有フォルダ設定...」を選び、「アクセス権」という文字の右にある「新規共有フォルダを追加します」をクリックする。

9. フォルダのパスとフォルダ名を設定し、「自動マウント」と「永続化する」にチェックを入れる。このとき、容量の大きいドライブに共有フォルダを作るほうがよい。

10. VirtualBoxの「デバイス」から「Guest Additions CDイメージの挿入...」をクリック。

11. このとき、「"VBoxGAs5.2.12"には自動的に起動するソフトウェアが含まれています。実行しますか？」と出るので、それを実行する。

12. 処理が終わるまで待ち、「Press Return to close this window...」とでると、Enterキーを押す。

13. 仮想マシンを閉じて再度開く。このとき、「仮想マシンの電源オフ」にチェックを入れてOKする。

14. ランチャーの「ファイル」を開いて、「sf_ユーザー名」フォルダが存在することを確認する。

15. デスクトップを右クリックして、「端末を開く」をクリックして端末を開く。

16. sudo suコマンドを入力。

17. 端末にgpasswd -a ユーザー名 vboxsfと打って、共有フォルダを管理者権限なしで開けるようにする。

18. 仮想マシンを閉じて再度開く。このとき、「仮想マシンの電源オフ」にチェックを入れてOKする。

19. ランチャーの「ファイル」を開いて、「sf_ユーザー名」フォルダが開けることを確認する。

20. ランチャーの「Ubuntuソフトウェア」を開いて、「更新」をクリックし、少し待って、「OSの更新」が表示されたら、「インストール（I）」をクリックする。

21. その後、「ソフトウェアは最新です」と表示されるのを確認する。

## 4. gromacsの導入
1. gromacsをダウンロード（必ずtar.gzを選ぶ）。

2. ランチャーの「ファイル」から「ダウンロード」フォルダを開き、ダウンロードしてきたgromacsファイル2があることを確認して、「ホーム」フォルダに移動する。

3. 右クリックから「ここで展開する」をクリック。

4. 端末を開いて、次のように入力する。  
cd 展開したgromacsのファイルのパス  
mkdir build  
cd build  
sudo apt install cmake

5. 「この操作後に追加で20.5MBのディスク容量が消費されます。続行しますか？」と出ると、Yを入力しEnterキーを押す。

6. 端末につぎのように入力する。  
cmake .. -DGMX_BUILD_OWN_FFTW=ON -DREGRESSIONTEST_DOWNLOAD=ON  
make  
make check  
sudo make install  
cd  
vi .vimrc  

7. .vimrcファイルに「set nocompatible」とだけ書く。この操作によって、十字キーを使ってもABCDと打たれなくなる。

8. 端末にvi .bashrcと入力する。

9. 開いた.bashrcファイルの一番最後に、source /usr/local/gromacs/bin/GMXRCとつける。

10. 端末にbashと入力する。

初版：2017/07/09  
二版：2017/07/11  
三版：2017/07/12  
四版：2017/07/12  
五版：2017/07/13  
六版：2017/07/13  
七版：2017/07/13  
八版：2017/07/13  
九版：2017/07/15  
十版：2018/08/12  
十一版：2018/09/10